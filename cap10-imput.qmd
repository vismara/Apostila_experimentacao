---
title: "ğŸ“– ImputaÃ§Ã£o de Valores Perdidos em Experimentos"
---

*MÃ³dulo 2 â€“ Semana 12*

## ğŸŒ± Contexto aplicado

Na prÃ¡tica experimental, Ã© comum ocorrerem **falhas de observaÃ§Ã£o**: mudas perdidas, parcelas sem leitura ou erros de anotaÃ§Ã£o. Esses casos geram **valores ausentes (NA)**, inviabilizando a **ANOVA clÃ¡ssica** e o uso direto do **ExpDes.pt**.

ğŸ’¡ A **imputaÃ§Ã£o** consiste em **estimar/substituir** valores faltantes de modo coerente com o delineamento, preservando conclusÃµes e permitindo a anÃ¡lise.

---

## ğŸ¯ Objetivos
- Diagnosticar **valores perdidos** e suas causas.  
- Aplicar **imputaÃ§Ã£o simples** (mÃ©dia do tratamento) de forma transparente.  
- Avaliar **impacto** da imputaÃ§Ã£o nas conclusÃµes (ANOVA + grÃ¡ficos).  
- Preparar **relatÃ³rios reprodutÃ­veis**.

---

## ğŸ§  Tipos de ausÃªncias
| Tipo | DescriÃ§Ã£o | Exemplo |
|---|---|---|
| **MCAR** | completamente ao acaso | quebra acidental de etiqueta |
| **MAR** | dependente de variÃ¡vel observÃ¡vel | sensor falha em dias quentes |
| **MNAR** | depende do valor nÃ£o observado | parcelas fracas perdem mais dados |

No ensino e em rotinas simples, assumimos **MCAR/MAR** e priorizamos **imputaÃ§Ã£o parcimoniosa**.

---

## ğŸ”§ EstratÃ©gias prÃ¡ticas de imputaÃ§Ã£o
| EstratÃ©gia | Quando usar | ObservaÃ§Ãµes |
|---|---|---|
| **MÃ©dia do tratamento** | faltas pontuais | preserva comparabilidade entre tratamentos |
| MÃ©dia global | poucas faltas dispersas | pode subestimar variÃ¢ncia |
| RegressÃ£o local | variÃ¡vel auxiliar confiÃ¡vel | demanda ajuste adicional |
| InterpolaÃ§Ã£o | sÃ©ries temporais | mantÃ©m tendÃªncia |
| AleatÃ³ria controlada | simular variaÃ§Ã£o realista | usar com cautela |

::: callout-note
Sempre **documente** qual critÃ©rio foi adotado e **quantos valores** foram imputados. Se o nÃºmero de faltas for alto (>10%), reavalie o experimento.
:::

---

## ğŸŒ³ EXEMPLO â€” AdubaÃ§Ã£o Ã— Altura com uma falta (DIC)

**Contexto:** trÃªs adubaÃ§Ãµes (A1, A2, A3), 5 repetiÃ§Ãµes; uma leitura perdida em **A3**.

ğŸ“¦ **Dados:** [dados/adubacao_altura_faltante.csv](/dados/adubacao_altura_faltante.csv)

```{r}
library(readr); library(dplyr); library(ggplot2); library(ExpDes.pt)

d <- read_csv("dados/adubacao_altura_faltante.csv", show_col_types = FALSE)

# VerificaÃ§Ã£o
summary(d)
any(is.na(d$Altura_cm))
```

A funÃ§Ã£o `dic` falha com NA:
```{r}
# dic(trat = d$Tratamento, resp = d$Altura_cm, quali = TRUE)
```

### ImputaÃ§Ã£o pela **mÃ©dia do tratamento**
```{r}
med <- d |>
  group_by(Tratamento) |>
  summarise(media_trat = mean(Altura_cm, na.rm = TRUE), .groups="drop")

d_imp <- d |>
  left_join(med, by = "Tratamento") |>
  mutate(Altura_imp = ifelse(is.na(Altura_cm), media_trat, Altura_cm)) |>
  select(-media_trat)

any(is.na(d_imp$Altura_imp))
```

### ANOVA apÃ³s imputaÃ§Ã£o + boxplot
```{r}
out <- dic(trat = d_imp$Tratamento, resp = d_imp$Altura_imp, quali = TRUE)

ggplot(d_imp, aes(Tratamento, Altura_imp, fill = Tratamento)) +
  geom_boxplot(alpha = .5) +
  labs(title = "Altura (cm) apÃ³s imputaÃ§Ã£o pela mÃ©dia do tratamento",
       y = "Altura (cm)") +
  theme_minimal()
```

---

## ğŸŒ¿ ATIVIDADE â€” Brotos com duas faltas (DIC, contagem)

**Contexto:** cinco bioestimulantes (B1â€“B5); duas faltas em **B1** por erro de anotaÃ§Ã£o.

ğŸ“¦ **Dados:** [dados/brotos_cedrela_faltante.csv](/dados/brotos_cedrela_faltante.csv)

### Tarefas
1. Detecte as cÃ©lulas **NA** e tente rodar `dic` (deve falhar).  
2. Impute usando **mÃ©dia do tratamento**.  
3. RefaÃ§a a ANOVA e o boxplot.  

---

## âœ… SÃ­ntese
- O **ExpDes.pt** nÃ£o aceita **NA** â€” impute de forma **simples e documentada**.  
- A **mÃ©dia do tratamento** Ã© o caminho didÃ¡tico para faltas pontuais.  
- Sempre avalie o **impacto** nos resultados e registre a decisÃ£o no relatÃ³rio.



