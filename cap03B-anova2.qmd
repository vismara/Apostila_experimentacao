---
title: "ğŸ“– CapÃ­tulo 3B â€“ ANOVA II: Pressupostos e Teste de MÃ©dias"
---

*MÃ³dulo 1 â€“ Semana 4*

## ğŸŒ± Narrativa inicial

Na aula passada, a ANOVA mostrou que **hÃ¡ diferenÃ§a global** entre os tratamentos.  
Mas o(a) engenheiro(a) florestal precisa de algo mais prÃ¡tico: **quais tratamentos sÃ£o diferentes** e se pode confiar nesses resultados.  
Ã‰ aqui que entram os **pressupostos** e os **testes de mÃ©dias**.

::: callout-tip
ğŸ“Œ **Na prÃ¡tica:** sÃ³ podemos recomendar um tratamento se tivermos **confianÃ§a estatÃ­stica** de que o resultado nÃ£o Ã© fruto do acaso ou de distorÃ§Ãµes.
:::

## ğŸ¯ Objetivos do capÃ­tulo

- Explicar **o que sÃ£o pressupostos** e por que importam.  
- Entender **como funcionam os testes de mÃ©dias**.  
- Gerar e interpretar **boxplots com letras** do Tukey.  
- Consolidar a anÃ¡lise com dois experimentos florestais.

---

## ğŸ§  O que sÃ£o pressupostos?

A ANOVA Ã© um **modelo estatÃ­stico** e, como todo modelo, depende de condiÃ§Ãµes para funcionar.  
Essas condiÃ§Ãµes sÃ£o chamadas de **pressupostos**.

1. **Normalidade dos resÃ­duos**  
   - Os â€œerrosâ€ do modelo devem seguir uma distribuiÃ§Ã£o aproximadamente normal.  
   - Garante que os p-valores do teste F sejam confiÃ¡veis.

2. **Homogeneidade das variÃ¢ncias**  
   - A variabilidade dentro dos grupos deve ser semelhante.  
   - Se um grupo tem variÃ¢ncia muito maior, ele â€œpuxaâ€ a decisÃ£o.

ğŸ‘‰ **ImportÃ¢ncia:** Se os pressupostos nÃ£o forem atendidos, a conclusÃ£o da ANOVA pode ser **enganosa**.  

No R, verificamos com:  
- **Shapiro-Wilk** (normalidade)  
- **Levene** (homogeneidade)  

---

## ğŸŒ³ O que sÃ£o testes de mÃ©dias?

A ANOVA responde apenas: **â€œtodas as mÃ©dias sÃ£o iguais?â€**  
Se a resposta Ã© â€œnÃ£oâ€, surge a pergunta: **â€œquais grupos diferem entre si?â€**

- O **teste de mÃ©dias** compara pares de mÃ©dias. 
- Em geral eles tem como principio o calculo de uma distÃ¢ncia mÃ­nima significativa. 
- O teste de **Tukey HSD** Ã© o mais comum.  
- Resultado:  
  - Texto com pares significativos.  
  - GrÃ¡fico com intervalos de confianÃ§a.  
  - **Boxplot com letras**: tratamentos com mesma letra nÃ£o diferem.

ğŸ‘‰ **Na prÃ¡tica florestal:** Ã© essa etapa que permite recomendar um substrato ou adubaÃ§Ã£o.

---

## ğŸŒ³ Experimento 1 â€“ *Eucalyptus grandis* (AdubaÃ§Ã£o)

**Contexto:** Viveiro comercial quer decidir entre **Controle**, **OrgÃ¢nica** e **QuÃ­mica**.  
**Delineamento:** 3 tratamentos, 10 mudas/tratamento; variÃ¡veis: Altura, DiÃ¢metro, Biomassa.

ğŸ“¦ **Dados desta anÃ¡lise**

  - [`dados/eucalipto_adubacao.csv`](dados/eucalipto_adubacao.csv)  
  
  - No Colab: `/content/eucalipto_adubacao.csv`  
  
  - No Quarto local: `dados/eucalipto_adubacao.csv`

### 1. Ajuste do modelo (Altura)
```{r}
library(readr); library(dplyr); library(agricolae); library(ggplot2); library(tibble); library(car)

euca <- read_csv("dados/eucalipto_adubacao.csv", show_col_types = FALSE)
mod_alt <- aov(Altura_cm ~ Tratamento, data = euca)
summary(mod_alt)
```

### 2. VerificaÃ§Ã£o dos pressupostos
```{r}
shapiro.test(residuals(mod_alt))
leveneTest(Altura_cm ~ Tratamento, data = euca)
```

### 3. Teste de mÃ©dias (Tukey) com letras
```{r}
tk <- HSD.test(mod_alt, "Tratamento", group = TRUE)
tk$groups
```

```{r}
# 1) Transformar o tk$groups em um data frame com colunas explÃ­citas
letras_df <- tk$groups %>%
  rownames_to_column(var = "Tratamento") %>%
  rename(letra = groups)

# 2) PosiÃ§Ã£o vertical (y) das letras: mÃ¡ximo por tratamento + uma folguinha
topos <- euca %>%
  group_by(Tratamento) %>%
  summarise(y = max(Altura_cm, na.rm = TRUE) + 1, .groups = "drop")

# 3) Juntando os dois conjunto de dados
letras_df <- letras_df |>
  left_join(topos, by = "Tratamento")
```


```{r}
# 4) GrÃ¡fico final com letras
ggplot(euca, aes(x = Tratamento, y = Altura_cm, fill = Tratamento)) +
  geom_boxplot() +
  geom_text(data = letras_df,
            aes(x = Tratamento, y = y, label = letra),
            inherit.aes = FALSE) +
  labs(title = "Altura de Eucalyptus por adubaÃ§Ã£o",
       x = "Tratamento", y = "Altura (cm)") +
  theme_minimal()

```

**Como ler:** Tratamentos com **mesma letra** nÃ£o diferem; letras diferentes = diferenÃ§a significativa.

---

## ğŸŒ¿ Experimento 2 â€“ Mudas nativas (Substratos)

**Contexto:** Viveiro de nativas para restauraÃ§Ã£o precisa escolher o substrato mais eficiente.  
**Delineamento:** 3 substratos, *n* mudas/tratamento; variÃ¡vel: Biomassa.

ğŸ“¦ **Dados desta anÃ¡lise**  

  - [`dados/crescimento_mudas.csv`](dados/crescimento_mudas.csv) 
  
  - No Colab: use o link direto no `read_csv()`  
  
  - No Quarto local: `dados/crescimento_mudas.csv`

### 1. Ajuste do modelo
```{r}
mudas <- read_csv("dados/crescimento_mudas.csv", show_col_types = FALSE)
mod_bio <- aov(Biomassa_g ~ Tratamento, data = mudas)
summary(mod_bio)
```

### 2. Pressupostos

```{r}
shapiro.test(residuals(mod_bio))
leveneTest(Biomassa_g ~ Tratamento, data = mudas)
```

### 3. Teste de mÃ©dias (Tukey) com letras

```{r}
tk_bio <- HSD.test(mod_bio, "Tratamento", group = TRUE)
tk_bio$groups
```



```{r}
# 1) Transformar o tk$groups em um data frame com colunas explÃ­citas
letras_df <- tk_bio$groups %>%
  rownames_to_column(var = "Tratamento") %>%
  rename(letra = groups)

# 2) PosiÃ§Ã£o vertical (y) das letras: mÃ¡ximo por tratamento + uma folguinha
topos <- mudas %>%
  group_by(Tratamento) %>%
  summarise(y = max(Biomassa_g, na.rm = TRUE) + 1, .groups = "drop")

# 3) Juntando os dois conjunto de dados
letras_df <- letras_df |>
  left_join(topos, by = "Tratamento")
```


```{r}
# 4) GrÃ¡fico final com letras
ggplot(mudas, aes(x = Tratamento, y = Biomassa_g, fill = Tratamento)) +
  geom_boxplot() +
  geom_text(data = letras_df,
            aes(x = Tratamento, y = y, label = letra),
            inherit.aes = FALSE) +
  labs(title = "Biomassa por substrato",
       x = "Tratamento", y = "Biomassa (g)") +
  theme_minimal()

```

---

## ğŸ“ ExercÃ­cios

1. No experimento com **Eucalipto**, aplique Tukey tambÃ©m para **DiÃ¢metro** e **Biomassa**.  
2. No experimento com **Mudas**, faÃ§a o mesmo para **Altura**.  
3. Analise os resultados e discuta: os tratamentos â€œmelhoresâ€ coincidem entre variÃ¡veis?  

---

## âœ… SÃ­ntese

- **Pressupostos** = condiÃ§Ãµes para que a ANOVA seja vÃ¡lida.  
- **Teste de mÃ©dias** = detalha onde estÃ£o as diferenÃ§as.  
- **Boxplots com letras** tornam a interpretaÃ§Ã£o imediata.  

